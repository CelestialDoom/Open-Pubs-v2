Imports System.Threading
Imports Windows.Devices.Geolocation
Imports Windows.UI.Popups

Module Variables

    Public LocalAuthority As String() = {"Aberdeen City", "Aberdeenshire", "Adur", "Allerdale", "Amber Valley", "Angus", "Argyll and Bute", "Arun", "Ashfield", "Ashford", "Aylesbury Vale", "Babergh", "Barking and Dagenham", "Barnet", "Barnsley", "Barrow-in-Furness", "Basildon", "Basingstoke and Deane", "Bassetlaw", "Bath and North East Somerset", "Bedford", "Bexley", "Birmingham", "Blaby", "Blackburn with Darwen", "Blackpool", "Blaenau Gwent", "Bolsover", "Bolton", "Boston", "Bournemouth", "Bracknell Forest", "Bradford", "Braintree", "Breckland", "Brent", "Brentwood", "Bridgend", "Brighton and Hove", "Bristol, City of", "Broadland", "Bromley", "Bromsgrove", "Broxbourne", "Broxtowe", "Burnley", "Bury", "Caerphilly", "Calderdale", "Cambridge", "Camden", "Cannock Chase", "Canterbury", "Cardiff", "Carlisle", "Carmarthenshire", "Castle Point", "Central Bedfordshire", "Ceredigion", "Charnwood", "Chelmsford", "Cheltenham", "Cherwell", "Cheshire East", "Cheshire West and Chester", "Chesterfield", "Chichester", "Chiltern", "Chorley", "Christchurch", "City of Edinburgh", "City of London", "Clackmannanshire", "Colchester", "Conwy", "Copeland", "Cornwall", "Cotswold", "County Durham", "Coventry", "Craven", "Crawley", "Croydon", "Dacorum", "Darlington", "Dartford", "Daventry", "Denbighshire", "Derby", "Derbyshire Dales", "Doncaster", "Dover", "Dudley", "Dumfries and Galloway", "Dundee City", "Ealing", "East Ayrshire", "East Cambridgeshire", "East Devon", "East Dorset", "East Dunbartonshire", "East Hampshire", "East Hertfordshire", "East Lindsey", "East Lothian", "East Northamptonshire", "East Renfrewshire", "East Riding of Yorkshire", "East Staffordshire", "Eastbourne", "Eastleigh", "Eden", "Elmbridge", "Enfield", "Epping Forest", "Epsom and Ewell", "Erewash", "Exeter", "Falkirk", "Fareham", "Fenland", "Fife", "Flintshire", "Forest Heath", "Forest of Dean", "Fylde", "Gateshead", "Gedling", "Glasgow City", "Gloucester", "Gosport", "Gravesham", "Great Yarmouth", "Greenwich", "Guildford", "Gwynedd", "Hackney", "Halton", "Hambleton", "Hammersmith and Fulham", "Harborough", "Haringey", "Harlow", "Harrogate", "Harrow", "Hart", "Hartlepool", "Hastings", "Havant", "Havering", "Herefordshire, County of", "Hertsmere", "High Peak", "Highland", "Hillingdon", "Hinckley and Bosworth", "Horsham", "Hounslow", "Huntingdonshire", "Hyndburn", "Inverclyde", "Ipswich", "Isle of Anglesey", "Isle of Wight", "Isles of Scilly", "Islington", "Kensington and Chelsea", "Kettering", "King's Lynn and West Norfolk", "Kingston upon Hull, City of", "Kingston upon Thames", "Kirklees", "Knowsley", "Lambeth", "Lancaster", "Leeds", "Leicester", "Lewes", "Lewisham", "Lichfield", "Lincoln", "Liverpool", "Luton", "Maidstone", "Maldon", "Malvern Hills", "Manchester", "Mansfield", "Medway", "Melton", "Mendip", "Merthyr Tydfil", "Merton", "Mid Devon", "Mid Suffolk", "Mid Sussex", "Middlesbrough", "Midlothian", "Milton Keynes", "Mole Valley", "Monmouthshire", "Moray", "Na h-Eileanan Siar", "Neath Port Talbot", "New Forest", "Newark and Sherwood", "Newcastle upon Tyne", "Newcastle-under-Lyme", "Newham", "Newport", "North Ayrshire", "North Devon", "North Dorset", "North East Derbyshire", "North East Lincolnshire", "North Hertfordshire", "North Kesteven", "North Lanarkshire", "North Lincolnshire", "North Norfolk", "North Somerset", "North Tyneside", "North Warwickshire", "North West Leicestershire", "Northampton", "Northumberland", "Norwich", "Nottingham", "Nuneaton and Bedworth", "Oadby and Wigston", "Oldham", "Orkney Islands", "Oxford", "Pembrokeshire", "Pendle", "Perth and Kinross", "Peterborough", "Plymouth", "Poole", "Portsmouth", "Powys", "Preston", "Purbeck", "Reading", "Redbridge", "Redcar and Cleveland", "Redditch", "Reigate and Banstead", "Renfrewshire", "Rhondda Cynon Taf", "Ribble Valley", "Richmond upon Thames", "Richmondshire", "Rochdale", "Rochford", "Rossendale", "Rother", "Rotherham", "Rugby", "Runnymede", "Rushcliffe", "Rushmoor", "Rutland", "Ryedale", "Salford", "Sandwell", "Scarborough", "Scottish Borders", "Sedgemoor", "Sefton", "Selby", "Sevenoaks", "Sheffield", "Shepway", "Shetland Islands", "Shropshire", "Slough", "Solihull", "South Ayrshire", "South Bucks", "South Cambridgeshire", "South Derbyshire", "South Gloucestershire", "South Hams", "South Holland", "South Kesteven", "South Lakeland", "South Lanarkshire", "South Norfolk", "South Northamptonshire", "South Oxfordshire", "South Ribble", "South Somerset", "South Staffordshire", "South Tyneside", "Southampton", "Southend-on-Sea", "Southwark", "Spelthorne", "St Albans", "St Edmundsbury", "St. Helens", "Stafford", "Staffordshire Moorlands", "Stevenage", "Stockport", "Stockton-on-Tees", "Stoke-on-Trent", "Stratford-on-Avon", "Stroud", "Suffolk Coastal", "Sunderland", "Surrey Heath", "Sutton", "Swale", "Swansea", "Swindon", "Tameside", "Tamworth", "Tandridge", "Taunton Deane", "Teignbridge", "Telford and Wrekin", "Tendring", "Test Valley", "Tewkesbury", "Thanet", "Three Rivers", "Thurrock", "Tonbridge and Malling", "Torbay", "Torfaen", "Torridge", "Tower Hamlets", "Trafford", "Tunbridge Wells", "Uttlesford", "Vale of Glamorgan", "Vale of White Horse", "Wakefield", "Walsall", "Waltham Forest", "Wandsworth", "Warrington", "Warwick", "Watford", "Waveney", "Waverley", "Wealden", "Wellingborough", "Welwyn Hatfield", "West Berkshire", "West Devon", "West Dorset", "West Dunbartonshire", "West Lancashire", "West Lindsey", "West Lothian", "West Oxfordshire", "West Somerset", "Westminster", "Weymouth and Portland", "Wigan", "Wiltshire", "Winchester", "Windsor and Maidenhead", "Wirral", "Woking", "Wokingham", "Wolverhampton", "Worcester", "Worthing", "Wrexham", "Wychavon", "Wycombe", "Wyre Forest", "Wyre", "York"}

    Public Function LoadLocalAuthorityCmb()
        Return LocalAuthority
    End Function

    Public Function LoadLstView()
        Return P_Name
    End Function

    Public FoundCount As Integer = 0

    Public PubName As New List(Of String)
    Public PubAddress As New List(Of String)
    Public PubPostcode As New List(Of String)
    Public PubLatitude As New List(Of String)
    Public PubLongitude As New List(Of String)
    Public PubLocalAuthority As New List(Of String)

    Public P_Name(60000) As String
    Public P_Address(60000) As String
    Public P_Postcode(60000) As String
    Public P_Latitude(60000) As String
    Public P_Longitude(60000) As String

    Public AboutApp As String() = {"About Open Pubs", "What is Open Pubs?" & vbCrLf & vbCrLf & "This app will help you (the users) to find pubs in the city, or town, that you're in." & vbCrLf & vbCrLf & "• How?" & vbCrLf & "• The app uses data that is openly(?) available at Get The Data (getthedata.com). In general, it uses the Open Pubs data (open_pubs.csv.zip)." & vbCrLf & vbCrLf & "• What's it written in?" & vbCrLf & "• It's been coded using Visual Studio 2017 Community Edition." & vbCrLf & "The whole source code will be available on GitHub, at some point in time, for you to see." & vbCrLf & vbCrLf & "• Who do I contact if there's a problem?" & vbCrLf & vbCrLf & "celestial_doom@derpymail.org" & vbCrLf & vbCrLf & "----------" & vbCrLf & vbCrLf & "Made with ♥ in the UK"}

    Public Licence As String() = {"3rd Party Licence", "Open Government Licence v3.0" & vbCrLf & vbCrLf & "You are encouraged to use and re-use the Information that is available under this licence freely and flexibly, with only a few conditions." & vbCrLf & "Using Information under this licence" & vbCrLf & vbCrLf & "Use of copyright and database right material expressly made available under this licence (the 'Information') indicates your acceptance of the terms and conditions below." & vbCrLf & vbCrLf & "The Licensor grants you a worldwide, royalty-free, perpetual, non-exclusive licence to use the Information subject to the conditions below." & vbCrLf & vbCrLf & "This licence does not affect your freedom under fair dealing or fair use or any other copyright or database right exceptions and limitations." & vbCrLf & "You are free to:" & vbCrLf & vbCrLf & "copy, publish, distribute and transmit the Information;" & vbCrLf & vbCrLf & "adapt the Information;" & vbCrLf & vbCrLf & "exploit the Information commercially and non-commercially for example, by combining it with other Information, or by including it in your own product or application." & vbCrLf & vbCrLf & "You must (where you do any of the above):" & vbCrLf & vbCrLf & "acknowledge the source of the Information in your product or application by including or linking to any attribution statement specified by the Information Provider(s) and, where possible, provide a link to this licence;" & vbCrLf & vbCrLf & "If the Information Provider does not provide a specific attribution statement, you must use the following:" & vbCrLf & vbCrLf & "Contains public sector information licensed under the Open Government Licence v3.0." & vbCrLf & vbCrLf & "If you are using Information from several Information Providers and listing multiple attributions is not practical in your product or application, you may include a URI or hyperlink to a resource that contains the required attribution statements." & vbCrLf & vbCrLf & "These are important conditions of this licence and if you fail to comply with them the rights granted to you under this licence, or any similar licence granted by the Licensor, will end automatically." & vbCrLf & "Breezeicons-emblems-16-vcs-locally-modified-unstaged.svg Exemptions" & vbCrLf & vbCrLf & "This licence does not cover:" & vbCrLf & vbCrLf & "personal data in the Information;" & vbCrLf & "Information that has not been accessed by way of publication or disclosure under information access legislation (including the Freedom of Information Acts for the UK and Scotland) by or with the consent of the Information Provider;" & vbCrLf & "departmental or public sector organisation logos, crests and the Royal Arms except where they form an integral part of a document or dataset;" & vbCrLf & "military insignia;" & vbCrLf & "third party rights the Information Provider is not authorised to license;" & vbCrLf & "other intellectual property rights, including patents, trade marks, and design rights; and" & vbCrLf & "identity documents such as the British Passport" & vbCrLf & vbCrLf & "Non-endorsement" & vbCrLf & vbCrLf & "This licence does not grant you any right to use the Information in a way that suggests any official status or that the Information Provider and/or Licensor endorse you or your use of the Information." & vbCrLf & "No warranty" & vbCrLf & vbCrLf & "The Information is licensed 'as is' and the Information Provider and/or Licensor excludes all representations, warranties, obligations and liabilities in relation to the Information to the maximum extent permitted by law." & vbCrLf & vbCrLf & "The Information Provider and/or Licensor are not liable for any errors or omissions in the Information and shall not be liable for any loss, injury or damage of any kind caused by its use. The Information Provider does not guarantee the continued supply of the Information." & vbCrLf & "Governing Law" & vbCrLf & vbCrLf & "This licence is governed by the laws of the jurisdiction in which the Information Provider has its principal place of business, unless otherwise specified by the Information Provider." & vbCrLf & "Definitions" & vbCrLf & vbCrLf & "In this licence, the terms below have the following meanings:" & vbCrLf & vbCrLf & "'Information' means information protected by copyright or by database right (for example, literary and artistic works, content, data and source code) offered for use under the terms of this licence." & vbCrLf & vbCrLf & "'Information Provider' means the person or organisation providing the Information under this licence." & vbCrLf & vbCrLf & "'Licensor' means any Information Provider which has the authority to offer Information under the terms of this licence or the Keeper of Public Records, who has the authority to offer Information subject to Crown copyright and Crown database rights and Information subject to copyright and database right that has been assigned to or acquired by the Crown, under the terms of this licence." & vbCrLf & vbCrLf & "'Use' means doing any act which is restricted by copyright or database right, whether in the original medium or in any other medium, and includes without limitation distributing, copying, adapting, modifying as may be technically necessary to use it in a different mode or format." & vbCrLf & vbCrLf & "'You', 'you' and 'your' means the natural or legal person, or body of persons corporate or incorporate, acquiring rights in the Information (whether the Information is obtained directly from the Licensor or otherwise) under this licence." & vbCrLf & "About the Open Government Licence" & vbCrLf & vbCrLf & "The National Archives has developed this licence as a tool to enable Information Providers in the public sector to license the use and re-use of their Information under a common open licence. The National Archives invites public sector bodies owning their own copyright and database rights to permit the use of their Information under this licence." & vbCrLf & vbCrLf & "The Keeper of the Public Records has authority to license Information subject to copyright and database right owned by the Crown. The extent of the offer to license this Information under the terms of this licence is set out in the UK Government Licensing Framework." & vbCrLf & vbCrLf & "This is version 3.0 of the Open Government Licence. The National Archives may, from time to time, issue new versions of the Open Government Licence. If you are already using Information under a previous version of the Open Government Licence, the terms of that licence will continue to apply." & vbCrLf & vbCrLf & "These terms are compatible with the Creative Commons Attribution License 4.0 and the Open Data Commons Attribution License, both of which license copyright and database rights. This means that when the Information is adapted and licensed under either of those licences, you automatically satisfy the conditions of the OGL when you comply with the other licence. The OGLv3.0 is Open Definition compliant." & vbCrLf & vbCrLf & "Further context, best practice and guidance can be found in the UK Government Licensing Framework section on The National Archives website." & vbCrLf & vbCrLf & "----------" & vbCrLf & vbCrLf & "The MIT License (MIT)" & vbCrLf & vbCrLf & "Copyright (c) 2015 Steve Hansen" & vbCrLf & vbCrLf & "Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the ""Software""), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:" & vbCrLf & vbCrLf & "The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software." & vbCrLf & vbCrLf & "THE SOFTWARE IS PROVIDED ""As Is"", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE." & vbCrLf & vbCrLf & "----------" & vbCrLf & vbCrLf & "Copyright (c) 2018, Workshell Ltd " & vbCrLf & "All rights reserved. " & vbCrLf & vbCrLf & "Redistribution and use in source and binary forms, with or without " & vbCrLf & "modification, are permitted provided that the following conditions are met: " & vbCrLf & "     * Redistributions of source code must retain the above copyright " & vbCrLf & "     notice, this list of conditions and the following disclaimer. " & vbCrLf & "     * Redistributions in binary form must reproduce the above copyright " & vbCrLf & "     notice, this list of conditions and the following disclaimer in the " & vbCrLf & "      documentation and/or other materials provided with the distribution. " & vbCrLf & "     * Neither the name of Workshell Ltd nor the names of its contributors " & vbCrLf & "      may be used to endorse or promote products " & vbCrLf & "      derived from this software without specific prior written permission. " & vbCrLf & vbCrLf & "THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS ""AS IS"" AND " & vbCrLf & "ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED " & vbCrLf & "WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE " & vbCrLf & "DISCLAIMED. IN NO EVENT SHALL WORKSHELL BE LIABLE FOR ANY " & vbCrLf & "DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES " & vbCrLf & "(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; " & vbCrLf & "LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND " & vbCrLf & "ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT " & vbCrLf & "(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS " & vbCrLf & "SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE."}

    Public AppName As String = Package.Current.DisplayName

    Public version = Package.Current.Id.Version
    Public appVersion As String = String.Format("{0}.{1}.{2}.{3}", version.Major, version.Minor, version.Build, version.Revision)

    Public Async Function displayMessageAsync(ByVal title As String, ByVal content As String, ByVal dialogType As String) As Task
        Dim messageDialog = New MessageDialog(content, title)
        If dialogType = "notification" Then
        Else
            messageDialog.Commands.Add(New UICommand("Yes", Nothing))
            messageDialog.Commands.Add(New UICommand("No", Nothing))
            messageDialog.DefaultCommandIndex = 0
        End If
        messageDialog.CancelCommandIndex = 1
        Dim cmdResult = Await messageDialog.ShowAsync()
        If cmdResult.Label = "Yes" Then
            Application.Current.Exit()
        End If
    End Function

    Public CityName As String
    Public Country As String

    Public ctsCancel As CancellationTokenSource
    Public WithEvents glGeo As New Geolocator
    Public Latitude_Value As Double
    Public Longitude_Value As Double

    Public BusStops(60) As String

    Public Function LoadBusStops()
        Return BusStops
    End Function

End Module